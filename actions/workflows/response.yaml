version: 1.0

description: Runs a Gluware workflow.

input:
  - device_name

vars:
  - workflow_id: "af06b8d9-4110-4f45-8149-a53950764913"
  - device_id: null
  - wf_exec_status: null


output:
  - device_id: <% ctx().device_id %>
  - wf_exec_status: <% ctx().wf_exec_status %>


tasks:
  task1:
    action: gluware.get_device_id device_name=<% ctx().device_name %>
    next:
      - when: <% succeeded() %>
        publish: device_id=<% result().result %>
        do: task2
  task2:
    action: gluware.run_workflow device_id=<% ctx().device_id %> workflow_id=<% ctx().workflow_id %>
    next:
      - when: <% succeeded() %>
        publish: wf_exec_status=<% result().result %>
     